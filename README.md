# 东方财富网股票数据爬虫项目

## 项目简介

这是一个专门用于爬取东方财富网股票数据的Python爬虫项目。该项目主要功能包括爬取股票代码与市场信息、获取股票周线K线数据并计算BOLL布林带指标，最终将数据保存为CSV文件供分析使用。

## 功能特性

- **高效爬取**：采用多线程和异步IO技术，大幅提高爬取效率
- **稳健可靠**：实现了请求重试机制、错误处理和去重逻辑
- **数据完整**：支持获取股票基本信息和技术指标数据
- **防反爬措施**：随机User-Agent、请求延迟等策略
- **数据可视化友好**：输出CSV格式数据，便于后续分析和可视化

## 项目结构

```
├── main.py           # 主入口文件
├── stock_craw.py     # 股票代码爬取模块
├── stock_get.py      # 股票数据获取和BOLL指标计算模块
├── stock_craw.csv    # 爬取的股票代码和市场信息（运行后生成）
├── stock_code.csv    # 股票周线数据和BOLL指标（运行后生成）
└── README.md         # 项目说明文档
```

## 技术栈

- **Python 3.10+**
- **httpx**：高性能HTTP客户端，支持异步请求
- **pandas**：数据处理和CSV文件操作
- **asyncio**：异步IO支持
- **concurrent.futures**：多线程支持
- **tqdm**：进度条显示

## 核心模块说明

### 1. 股票代码爬取模块 (stock_craw.py)

- **stock_page_get()**：获取总页数信息
- **stock_craw_code(page)**：爬取指定页码的股票代码和市场信息
- **stock_craw_page()**：多线程爬取所有页面的股票数据
- **crawl_single_page(page)**：单页面爬取和重试逻辑

### 2. 股票数据获取模块 (stock_get.py)

- **get_weekly_kline()**：异步获取股票周线K线数据
- **calculate_weekly_boll()**：计算BOLL布林带指标（中轨、上轨、下轨）
- **stock_csv_get()**：读取股票代码，批量获取数据并保存结果

## 使用方法

### 1. 安装依赖

```bash
pip install httpx pandas tqdm
```

### 2. 运行程序

直接运行主入口文件：

```bash
python main.py
```

运行流程：
1. 首先爬取股票代码和市场信息，保存到 `stock_craw.csv`
2. 然后读取股票代码，获取周线数据并计算BOLL指标，保存到 `stock_code.csv`

### 3. 单独运行模块

#### 仅爬取股票代码：
```bash
python stock_craw.py
```

#### 仅获取股票数据（需先运行代码爬取）：
```bash
python stock_get.py
```

## 数据说明

### stock_craw.csv 数据结构

- **code**：股票代码
- **market**：市场代码（1=沪市，0=深市）

### stock_code.csv 数据结构

- **week_date**：周日期
- **weekly_close**：周收盘价
- **boll_mid_weekly**：BOLL中轨（20周移动平均）
- **boll_up_weekly**：BOLL上轨（中轨+2倍标准差）
- **boll_dn_weekly**：BOLL下轨（中轨-2倍标准差）
- **code**：股票代码

## 注意事项

1. **网络请求限制**：项目已实现请求延迟和错误重试，但请合理控制爬取频率，避免对服务器造成过大压力
2. **异常处理**：程序会跳过无法获取数据的股票，确保整体流程不会中断
3. **数据准确性**：技术指标计算基于东方财富网提供的前复权数据
4. **安全性**：已禁用不安全请求警告，实际环境中请根据需要配置SSL验证

## 扩展建议

1. 添加更多技术指标计算
2. 实现定时自动更新功能
3. 增加GUI界面提高易用性
4. 添加数据库存储支持
5. 实现数据可视化展示

## 免责声明

本项目仅用于学习和研究目的，请勿用于商业用途。爬虫使用请遵守相关网站的robots协议和法律法规。
